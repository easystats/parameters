<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute group-meaned and de-meaned variables — check_heterogeneity • parameters</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute group-meaned and de-meaned variables — check_heterogeneity" />
<meta property="og:description" content="demean() computes group- and de-meaned versions of a
   variable that can be used in regression analysis to model the between-
   and within-subject effect. check_heterogeneity() checks if model
   predictors or variables may cause a heterogeneity bias, i.e. if variables
   have a within- and/or between-effect.
    
   degroup() is more generic in terms of the centering-operation.
   While demean() always uses mean-centering, degroup() can
   also use the mode or median for centering." />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parameters</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.14.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Features</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Parameters Description
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/model_parameters.html">Summary of Model Parameters</a>
    </li>
    <li>
      <a href="../articles/model_parameters_standardized.html">Standardized Model Parameters</a>
    </li>
    <li>
      <a href="../articles/model_parameters_robust.html">Robust Estimation of Standard Errors</a>
    </li>
    <li>
      <a href="../articles/model_parameters_mice.html">Model Parameters and Missing Data</a>
    </li>
    <li>
      <a href="../articles/demean.html">Panel Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Formatting and Printing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/model_parameters_formatting.html">Formatting Model Parameters</a>
    </li>
    <li>
      <a href="../articles/model_parameters_print.html">Printing Model Parameters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Dimension Reduction
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/parameters_reduction.html">Feature reduction (PCA, cMDS, ICA...)</a>
    </li>
    <li>
      <a href="../articles/efa_cfa.html">Structural models (EFA, CFA, SEM...)</a>
    </li>
    <li>
      <a href="../articles/parameters_selection.html">Parameters Selection</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/easystats/parameters/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute group-meaned and de-meaned variables</h1>
    <small class="dont-index">Source: <a href='https://github.com/easystats/parameters/blob/master/R/check_heterogeneity.R'><code>R/check_heterogeneity.R</code></a>, <a href='https://github.com/easystats/parameters/blob/master/R/demean.R'><code>R/demean.R</code></a></small>
    <div class="hidden name"><code>demean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>demean()</code> computes group- and de-meaned versions of a
   variable that can be used in regression analysis to model the between-
   and within-subject effect. <code>check_heterogeneity()</code> checks if model
   predictors or variables may cause a heterogeneity bias, i.e. if variables
   have a within- and/or between-effect.
   <br /> <br />
   <code>degroup()</code> is more generic in terms of the centering-operation.
   While <code>demean()</code> always uses mean-centering, <code>degroup()</code> can
   also use the mode or median for centering.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>check_heterogeneity</span><span class='op'>(</span><span class='va'>x</span>, select <span class='op'>=</span> <span class='cn'>NULL</span>, group <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>demean</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>select</span>,
  <span class='va'>group</span>,
  suffix_demean <span class='op'>=</span> <span class='st'>"_within"</span>,
  suffix_groupmean <span class='op'>=</span> <span class='st'>"_between"</span>,
  add_attributes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>degroup</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>select</span>,
  <span class='va'>group</span>,
  center <span class='op'>=</span> <span class='st'>"mean"</span>,
  suffix_demean <span class='op'>=</span> <span class='st'>"_within"</span>,
  suffix_groupmean <span class='op'>=</span> <span class='st'>"_between"</span>,
  add_attributes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>detrend</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>select</span>,
  <span class='va'>group</span>,
  center <span class='op'>=</span> <span class='st'>"mean"</span>,
  suffix_demean <span class='op'>=</span> <span class='st'>"_within"</span>,
  suffix_groupmean <span class='op'>=</span> <span class='st'>"_between"</span>,
  add_attributes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data frame. For <code>check_heterogeneity()</code>, may also be a mixed model object.</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>Character vector (or formula) with names of variables to select that should be group- and de-meaned. For <code>check_heterogeneity()</code>, if <code>x</code> is a mixed model object, this argument be ignored.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Character vector (or formula) with the name of the variable that indicates the group- or cluster-ID. For <code>check_heterogeneity()</code>, if <code>x</code> is a model object, this argument be ignored.</p></td>
    </tr>
    <tr>
      <th>suffix_demean, suffix_groupmean</th>
      <td><p>String value, will be appended to the names of the
group-meaned and de-meaned variables of <code>x</code>. By default, de-meaned
variables will be suffixed with <code>"_within"</code> and grouped-meaned variables
with <code>"_between"</code>.</p></td>
    </tr>
    <tr>
      <th>add_attributes</th>
      <td><p>Logical, if <code>TRUE</code>, the returned variables gain
attributes to indicate the within- and between-effects. This is only relevant
when printing <code><a href='model_parameters.html'>model_parameters()</a></code> - in such cases, the within- and
between-effects are printed in separated blocks.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Toggle warnings and messages.</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Method for centering. <code>demean()</code> always performs mean-centering, while <code>degroup()</code> can use <code>center = "median"</code> or <code>center = "mode"</code> for median- or mode-centering, and also <code>"min"</code> or <code>"max"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with the group-/de-meaned variables, which get the suffix
  <code>"_between"</code> (for the group-meaned variable) and <code>"_within"</code> (for
  the de-meaned variable) by default.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='heterogeneity-bias'><a class='anchor' aria-hidden='true' href='#heterogeneity-bias'></a>Heterogeneity Bias</h3>
<p>Mixed models include different levels of sources of variability, i.e.
    error terms at each level. When macro-indicators (or level-2 predictors,
    or higher-level units, or more general: <em>group-level predictors that
    <strong>vary</strong> within and across groups</em>) are included as fixed effects (i.e.
    treated as covariate at level-1), the variance that is left unaccounted for
    this covariate will be absorbed into the error terms of level-1 and level-2
    (<cite>Bafumi and Gelman 2006; Gelman and Hill 2007, Chapter 12.6.</cite>):
    &#8220;Such covariates contain two parts: one that is specific to the
    higher-level entity that does not vary between occasions, and one that
    represents the difference between occasions, within higher-level entities&#8221;
    (<cite>Bell et al. 2015</cite>). Hence, the error terms will be correlated with
    the covariate, which violates one of the assumptions of mixed models
    (iid, independent and identically distributed error terms). This bias is
    also called the <em>heterogeneity bias</em> (<cite>Bell et al. 2015</cite>). To
    resolve this problem, level-2 predictors used as (level-1) covariates should
    be separated into their "within" and "between" effects by "de-meaning" and
    "group-meaning": After demeaning time-varying predictors, &#8220;at the
    higher level, the mean term is no longer constrained by Level 1 effects,
    so it is free to account for all the higher-level variance associated
    with that variable&#8221; (<cite>Bell et al. 2015</cite>).</p><p></p><h3 class='hasAnchor' id='panel-data-and-correlating-fixed-and-group-effects'><a class='anchor' aria-hidden='true' href='#panel-data-and-correlating-fixed-and-group-effects'></a>Panel data and correlating fixed and group effects</h3>
<p><code>demean()</code> is intended to create group- and de-meaned variables
    for panel regression models (fixed effects models), or for complex
    random-effect-within-between models (see <cite>Bell et al. 2015, 2018</cite>),
    where group-effects (random effects) and fixed effects correlate (see
    <cite>Bafumi and Gelman 2006</cite>). This can happen, for instance, when
    analyzing panel data, which can lead to <em>Heterogeneity Bias</em>. To
    control for correlating predictors and group effects, it is recommended
    to include the group-meaned and de-meaned version of <em>time-varying covariates</em>
    (and group-meaned version of <em>time-invariant covariates</em> that are on
    a higher level, e.g. level-2 predictors) in the model. By this, one can
    fit complex multilevel models for panel data, including time-varying
    predictors, time-invariant predictors and random effects.</p><p></p><h3 class='hasAnchor' id='why-mixed-models-are-preferred-over-fixed-effects-models'><a class='anchor' aria-hidden='true' href='#why-mixed-models-are-preferred-over-fixed-effects-models'></a>Why mixed models are preferred over fixed effects models</h3>
<p>A mixed models approach can model the causes of endogeneity explicitly
    by including the (separated) within- and between-effects of time-varying
    fixed effects and including time-constant fixed effects. Furthermore,
    mixed models also include random effects, thus a mixed models approach
    is superior to classic fixed-effects models, which lack information of
    variation in the group-effects or between-subject effects. Furthermore,
    fixed effects regression cannot include random slopes, which means that
    fixed effects regressions are neglecting &#8220;cross-cluster differences
    in the effects of lower-level controls (which) reduces the precision of
    estimated context effects, resulting in unnecessarily wide confidence
    intervals and low statistical power&#8221; (<cite>Heisig et al. 2017</cite>).</p><p></p><h3 class='hasAnchor' id='terminology'><a class='anchor' aria-hidden='true' href='#terminology'></a>Terminology</h3>
<p>The group-meaned variable is simply the mean of an independent variable
    within each group (or id-level or cluster) represented by <code>group</code>.
    It represents the cluster-mean of an independent variable. The regression
    coefficient of a group-meaned variable is the <em>between-subject-effect</em>.
    The de-meaned variable is then the centered version of the group-meaned
    variable. De-meaning is sometimes also called person-mean centering or
    centering within clusters. The regression coefficient of a de-meaned
    variable represents the <em>within-subject-effect</em>.</p><p></p><h3 class='hasAnchor' id='de-meaning-with-continuous-predictors'><a class='anchor' aria-hidden='true' href='#de-meaning-with-continuous-predictors'></a>De-meaning with continuous predictors</h3>
<p>For continuous time-varying predictors, the recommendation is to include
    both their de-meaned and group-meaned versions as fixed effects, but not
    the raw (untransformed) time-varying predictors themselves. The de-meaned
    predictor should also be included as random effect (random slope). In
    regression models, the coefficient of the de-meaned predictors indicates
    the within-subject effect, while the coefficient of the group-meaned
    predictor indicates the between-subject effect.</p><p></p><h3 class='hasAnchor' id='de-meaning-with-binary-predictors'><a class='anchor' aria-hidden='true' href='#de-meaning-with-binary-predictors'></a>De-meaning with binary predictors</h3>
<p>For binary time-varying predictors, there are two recommendations. First
    is to include the raw (untransformed) binary predictor as fixed effect
    only and the <em>de-meaned</em> variable as random effect (random slope).
    The alternative would be to add the de-meaned version(s) of binary
    time-varying covariates as additional fixed effect as well (instead of
    adding it as random slope). Centering time-varying binary variables to
    obtain within-effects (level 1) isn't necessary. They have a sensible
    interpretation when left in the typical 0/1 format (<cite>Hoffmann 2015,
    chapter 8-2.I</cite>). <code>demean()</code> will thus coerce categorical time-varying
    predictors to numeric to compute the de- and group-meaned versions for
    these variables, where the raw (untransformed) binary predictor and the
    de-meaned version should be added to the model.</p><p></p><h3 class='hasAnchor' id='de-meaning-of-factors-with-more-than-levels'><a class='anchor' aria-hidden='true' href='#de-meaning-of-factors-with-more-than-levels'></a>De-meaning of factors with more than 2 levels</h3>
<p>Factors with more than two levels are demeaned in two ways: first, these
    are also converted to numeric and de-meaned; second, dummy variables
    are created (binary, with 0/1 coding for each level) and these binary
    dummy-variables are de-meaned in the same way (as described above).
    Packages like <span class="pkg">panelr</span> internally convert factors to dummies before
    demeaning, so this behaviour can be mimicked here.</p><p></p><h3 class='hasAnchor' id='de-meaning-interaction-terms'><a class='anchor' aria-hidden='true' href='#de-meaning-interaction-terms'></a>De-meaning interaction terms</h3>
<p>There are multiple ways to deal with interaction terms of within- and
    between-effects. A classical approach is to simply use the product
    term of the de-meaned variables (i.e. introducing the de-meaned variables
    as interaction term in the model formula, e.g. <code>y ~ x_within * time_within</code>).
    This approach, however, might be subject to bias (see <cite>Giesselmann &amp; Schmidt-Catran 2020</cite>).
    <br /> <br />
    Another option is to first calculate the product term and then apply the
    de-meaning to it. This approach produces an estimator &#8220;that reflects
    unit-level differences of interacted variables whose moderators vary
    within units&#8221;, which is desirable if <em>no</em> within interaction of
    two time-dependent variables is required. <br /> <br />
    A third option, when the interaction should result in a genuine within
    estimator, is to "double de-mean" the interaction terms
    (<cite>Giesselmann &amp; Schmidt-Catran 2018</cite>), however, this is currently
    not supported by <code>demean()</code>. If this is required, the <code>wmb()</code>
    function from the <span class="pkg">panelr</span> package should be used. <br /> <br />
    To de-mean interaction terms for within-between models, simply specify
    the term as interaction for the <code>select</code>-argument, e.g.
    <code>select = "a*b"</code> (see 'Examples').</p><p></p><h3 class='hasAnchor' id='analysing-panel-data-with-mixed-models-using-lme-'><a class='anchor' aria-hidden='true' href='#analysing-panel-data-with-mixed-models-using-lme-'></a>Analysing panel data with mixed models using lme4</h3>
<p>A description of how to translate the
    formulas described in <em>Bell et al. 2018</em> into R using <code><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer()</a></code>
    from <span class="pkg">lme4</span> can be found in
    <a href='https://easystats.github.io/parameters/articles/demean.html'>this vignette</a>.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Bafumi J, Gelman A. 2006. Fitting Multilevel Models When Predictors and Group Effects Correlate. In. Philadelphia, PA: Annual meeting of the American Political Science Association.</p></li>
<li><p>Bell A, Fairbrother M, Jones K. 2019. Fixed and Random Effects Models: Making an Informed Choice. Quality &amp; Quantity (53); 1051-1074</p></li>
<li><p>Bell A, Jones K. 2015. Explaining Fixed Effects: Random Effects Modeling of Time-Series Cross-Sectional and Panel Data. Political Science Research and Methods, 3(1), 133–153.</p></li>
<li><p>Gelman A, Hill J. 2007. Data Analysis Using Regression and Multilevel/Hierarchical Models. Analytical Methods for Social Research. Cambridge, New York: Cambridge University Press</p></li>
<li><p>Giesselmann M, Schmidt-Catran, AW. 2020. Interactions in fixed effects regression models. Sociological Methods &amp; Research, 1–28. https://doi.org/10.1177/0049124120914934</p></li>
<li><p>Heisig JP, Schaeffer M, Giesecke J. 2017. The Costs of Simplicity: Why Multilevel Models May Benefit from Accounting for Cross-Cluster Differences in the Effects of Controls. American Sociological Review 82 (4): 796–827.</p></li>
<li><p>Hoffman L. 2015. Longitudinal analysis: modeling within-person fluctuation and change. New York: Routledge</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>If grand-mean centering (instead of centering within-clusters)
  is required, see <code><a href='center.html'>center</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>iris</span><span class='op'>$</span><span class='va'>ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'># fake-ID</span></span>
<span class='r-in'><span class='va'>iris</span><span class='op'>$</span><span class='va'>binary</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fl'>1</span>, <span class='fl'>.35</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># binary variable</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>demean</span><span class='op'>(</span><span class='va'>iris</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Length"</span>, <span class='st'>"Petal.Length"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Sepal.Length_between Petal.Length_between Sepal.Length_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1             5.890698             3.927907          -0.7906977</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2             5.721622             3.645946          -0.8216216</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3             5.721622             3.645946          -1.0216216</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4             6.061290             4.129032          -1.4612903</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5             5.733333             3.382051          -0.7333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6             6.061290             4.129032          -0.6612903</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Petal.Length_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1           -2.527907</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2           -2.245946</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3           -2.345946</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4           -2.629032</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5           -1.982051</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6           -2.429032</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>demean</span><span class='op'>(</span><span class='va'>iris</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Length"</span>, <span class='st'>"binary"</span>, <span class='st'>"Species"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BBBB00;'>Categorical predictors (Species, binary) have been coerced to numeric values to compute de- and group-meaned variables.</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Sepal.Length_between Species_between binary_between Species_setosa_between</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1             5.890698       1.0930233      0.3488372              0.3023256</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2             5.721622       0.9459459      0.3513514              0.3513514</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3             5.721622       0.9459459      0.3513514              0.3513514</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4             6.061290       1.1935484      0.4516129              0.2258065</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5             5.733333       0.7948718      0.3076923              0.4358974</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6             6.061290       1.1935484      0.4516129              0.2258065</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Species_versicolor_between Species_virginica_between Sepal.Length_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                  0.3023256                 0.3953488          -0.7906977</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2                  0.3513514                 0.2972973          -0.8216216</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3                  0.3513514                 0.2972973          -1.0216216</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4                  0.3548387                 0.4193548          -1.4612903</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5                  0.3333333                 0.2307692          -0.7333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6                  0.3548387                 0.4193548          -0.6612903</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Species_within binary_within Species_setosa_within Species_versicolor_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1     -1.0930233    -0.3488372             0.6976744                -0.3023256</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2     -0.9459459    -0.3513514             0.6486486                -0.3513514</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3     -0.9459459     0.6486486             0.6486486                -0.3513514</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4     -1.1935484    -0.4516129             0.7741935                -0.3548387</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5     -0.7948718    -0.3076923             0.5641026                -0.3333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6     -1.1935484     0.5483871             0.7741935                -0.3548387</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Species_virginica_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1               -0.3953488</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2               -0.2972973</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3               -0.2972973</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4               -0.4193548</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5               -0.2307692</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6               -0.4193548</span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>check_heterogeneity</span><span class='op'>(</span><span class='va'>iris</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Length"</span>, <span class='st'>"Petal.Length"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Possible heterogeneity bias due to following predictors: <span style='color: #BB0000;'>Sepal.Length, Petal.Length</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># demean interaction term x*y</span></span>
<span class='r-in'><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span class='r-in'>  a <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span class='r-in'>  x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>  ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>demean</span><span class='op'>(</span><span class='va'>dat</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"x*y"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   a_between x_y_between   a_within x_y_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  2.666667    4.666667 -1.6666667 -0.6666667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  2.333333    4.000000 -0.3333333  2.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3  2.500000    4.500000  0.5000000 -1.5000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4  2.666667    4.666667  1.3333333  3.3333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5  2.333333    4.000000 -1.3333333  0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6  2.500000    4.500000 -0.5000000  1.5000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7  2.666667    4.666667  0.3333333 -2.6666667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  2.333333    4.000000  1.6666667 -2.0000000</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># or in formula-notation</span></span>
<span class='r-in'><span class='fu'>demean</span><span class='op'>(</span><span class='va'>dat</span>, select <span class='op'>=</span> <span class='op'>~</span> <span class='va'>a</span> <span class='op'>+</span> <span class='va'>x</span> <span class='op'>*</span> <span class='va'>y</span>, group <span class='op'>=</span> <span class='op'>~</span><span class='va'>ID</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   a_between x_y_between   a_within x_y_within</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  2.666667    4.666667 -1.6666667 -0.6666667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  2.333333    4.000000 -0.3333333  2.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3  2.500000    4.500000  0.5000000 -1.5000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4  2.666667    4.666667  1.3333333  3.3333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5  2.333333    4.000000 -1.3333333  0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6  2.500000    4.500000 -0.5000000  1.5000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7  2.666667    4.666667  0.3333333 -2.6666667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  2.333333    4.000000  1.6666667 -2.0000000</span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/mattansb" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Søren Højsgaard, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>



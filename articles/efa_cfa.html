<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Structural Models (EFA, CFA, SEM, ...) • parameters</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Structural Models (EFA, CFA, SEM, ...)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parameters</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.23.0.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Reference"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html" aria-label="Articles"><span class="fa fa-book-reader"></span> Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="News"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/parameters/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Structural Models (EFA, CFA, SEM, ...)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/parameters/blob/main/vignettes/efa_cfa.Rmd" class="external-link"><code>vignettes/efa_cfa.Rmd</code></a></small>
      <div class="d-none name"><code>efa_cfa.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-to-perform-a-factor-analysis-fa">How to perform a Factor Analysis (FA)<a class="anchor" aria-label="anchor" href="#how-to-perform-a-factor-analysis-fa"></a>
</h2>
<p>The difference between PCA and EFA can be quite hard to intuitively
grasp as their output is very familiar. The idea is that PCA aims at
extracting the most variance possible from all variables of the dataset,
whereas EFA aims at creating consistent factors from the dataset without
desperately trying to represent all the variables.</p>
<p>This is why PCA is popular for feature reduction, as it will try to
best represent the variance contained in the original data, minimizing
the loss of information. On the other hand, EFA is usually in the
context of exploring the latent dimensions that might be hidden in the
observed variables, without necessarily striving to represent the whole
dataset.</p>
<p>To illustrate EFA, let us use the <a href="https://ipip.ori.org/" class="external-link">International Personality Item Pool</a>
data available in the <a href="https://www.personality-project.org/r/html/bfi.html" class="external-link"><code>psych</code></a>
package. It includes 25 personality self report items. The authors built
these items following the <strong>big 5</strong> personality
structure.</p>
<div class="section level3">
<h3 id="factor-structure-sphericity-and-kmo">Factor Structure (Sphericity and KMO)<a class="anchor" aria-label="anchor" href="#factor-structure-sphericity-and-kmo"></a>
</h3>
<p>The first step is to test if the dataset is suitable for carrying out
factor analysis. There are two</p>
<ul>
<li><p><strong>Bartlett’s Test of Sphericity</strong>: This tests
whether a matrix (of correlations) is significantly different from an
identity matrix. The test provides probability that the correlation
matrix has significant correlations among at least some of the variables
in a dataset, a prerequisite for factor analysis to work. In other
words, before starting with factor analysis, one needs to check whether
Bartlett’s test of sphericity is significant.</p></li>
<li><p><strong>Kaiser, Meyer, Olkin (KMO) Measure of Sampling Adequacy
(MSA)</strong>: This test was introduced by Kaiser (1970) as the Measure
of Sampling Adequacy (MSA), later modified by Kaiser and Rice (1974).
The Kaiser-Meyer-Olkin (KMO) statistic, which can vary from 0 to 1,
indicates the degree to which each variable in a set is predicted
without error by the other variables. A value of 0 indicates that the
sum of partial correlations is large relative to the sum correlations,
indicating factor analysis is likely to be inappropriate. A KMO value
close to 1 indicates that the sum of partial correlations is not large
relative to the sum of correlations and so factor analysis should yield
distinct and reliable factors.</p></li>
</ul>
<p>Both tests can be performed by using the
<code><a href="https://easystats.github.io/performance/reference/check_factorstructure.html" class="external-link">performance::check_factorstructure()</a></code> function. First, we
set up the data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/" class="external-link">psych</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/psych/man/bfi.html" class="external-link">bfi</a></span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span> <span class="co"># Select only the 25 first columns corresponding to the items</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="co"># remove missing values</span></span></code></pre></div>
<p>Next, we check test if the dataset is suitable for carrying out
factor analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="co"># Check factor structure</span></span>
<span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_factorstructure.html" class="external-link">check_factorstructure</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Is the data suitable for Factor Analysis?</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - Sphericity: Bartlett's test of sphericity suggests that there is sufficient significant correlation in the data for factor analysis (Chisq(300) = 18146.07, p &lt; .001).</span></span>
<span><span class="co">#&gt;   - KMO: The Kaiser, Meyer, Olkin (KMO) overall measure of sampling adequacy suggests that data seems appropriate for factor analysis (KMO = 0.85). The individual KMO scores are: A1 (0.75), A2 (0.84), A3 (0.87), A4 (0.88), A5 (0.90), C1 (0.84), C2 (0.80), C3 (0.85), C4 (0.83), C5 (0.86), E1 (0.84), E2 (0.88), E3 (0.90), E4 (0.88), E5 (0.89), N1 (0.78), N2 (0.78), N3 (0.86), N4 (0.89), N5 (0.86), O1 (0.86), O2 (0.78), O3 (0.84), O4 (0.77), O5 (0.76).</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploratory-factor-analysis-efa">Exploratory Factor Analysis (EFA)<a class="anchor" aria-label="anchor" href="#exploratory-factor-analysis-efa"></a>
</h3>
<p>Now that we are confident that our dataset is appropriate, we will
explore a factor structure made of 5 latent variables, corresponding to
the items’ authors theory of personality.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit an EFA</span></span>
<span><span class="va">efa</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">data</span>, nfactors <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model_parameters.html">model_parameters</a></span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">TRUE</span>, threshold <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">efa</span></span>
<span><span class="co">#&gt; # Rotated loadings from Factor Analysis (oblimin-rotation)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable |  MR2 |   MR1 |   MR3 |   MR5 |   MR4 | Complexity | Uniqueness</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; N1       | 0.83 |       |       |       |       |       1.07 |       0.32</span></span>
<span><span class="co">#&gt; N2       | 0.78 |       |       |       |       |       1.03 |       0.39</span></span>
<span><span class="co">#&gt; N3       | 0.70 |       |       |       |       |       1.08 |       0.46</span></span>
<span><span class="co">#&gt; N5       | 0.48 |       |       |       |       |       2.00 |       0.65</span></span>
<span><span class="co">#&gt; N4       | 0.47 |       |       |       |       |       2.33 |       0.49</span></span>
<span><span class="co">#&gt; E2       |      |  0.67 |       |       |       |       1.08 |       0.45</span></span>
<span><span class="co">#&gt; E4       |      | -0.59 |       |       |       |       1.52 |       0.46</span></span>
<span><span class="co">#&gt; E1       |      |  0.55 |       |       |       |       1.22 |       0.65</span></span>
<span><span class="co">#&gt; E5       |      | -0.42 |       |       |       |       2.68 |       0.59</span></span>
<span><span class="co">#&gt; E3       |      | -0.41 |       |       |       |       2.65 |       0.56</span></span>
<span><span class="co">#&gt; C2       |      |       |  0.67 |       |       |       1.18 |       0.55</span></span>
<span><span class="co">#&gt; C4       |      |       | -0.64 |       |       |       1.13 |       0.52</span></span>
<span><span class="co">#&gt; C3       |      |       |  0.57 |       |       |       1.10 |       0.68</span></span>
<span><span class="co">#&gt; C5       |      |       | -0.56 |       |       |       1.41 |       0.56</span></span>
<span><span class="co">#&gt; C1       |      |       |  0.55 |       |       |       1.20 |       0.65</span></span>
<span><span class="co">#&gt; A3       |      |       |       |  0.68 |       |       1.06 |       0.46</span></span>
<span><span class="co">#&gt; A2       |      |       |       |  0.66 |       |       1.03 |       0.54</span></span>
<span><span class="co">#&gt; A5       |      |       |       |  0.54 |       |       1.48 |       0.53</span></span>
<span><span class="co">#&gt; A4       |      |       |       |  0.45 |       |       1.74 |       0.70</span></span>
<span><span class="co">#&gt; A1       |      |       |       | -0.44 |       |       1.88 |       0.80</span></span>
<span><span class="co">#&gt; O3       |      |       |       |       |  0.62 |       1.16 |       0.53</span></span>
<span><span class="co">#&gt; O5       |      |       |       |       | -0.54 |       1.21 |       0.70</span></span>
<span><span class="co">#&gt; O1       |      |       |       |       |  0.52 |       1.10 |       0.68</span></span>
<span><span class="co">#&gt; O2       |      |       |       |       | -0.47 |       1.68 |       0.73</span></span>
<span><span class="co">#&gt; O4       |      |       |       |       |  0.36 |       2.65 |       0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The 5 latent factors (oblimin rotation) accounted for 42.36% of the total variance of the original data (MR2 = 10.31%, MR1 = 8.83%, MR3 = 8.39%, MR5 = 8.29%, MR4 = 6.55%).</span></span></code></pre></div>
<p>As we can see, the 25 items nicely spread on the 5 latent factors,
the famous <strong>big 5</strong>. Based on this model, we can now
predict back the scores for each individual for these new variables:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">efa</span>,</span>
<span>  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Neuroticism"</span>, <span class="st">"Conscientiousness"</span>, <span class="st">"Extraversion"</span>, <span class="st">"Agreeableness"</span>, <span class="st">"Opennness"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># let's look only at the first five individuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Neuroticism Conscientiousness Extraversion Agreeableness Opennness</span></span>
<span><span class="co">#&gt; 1       -0.22            -0.128       -1.327        -0.855     -1.61</span></span>
<span><span class="co">#&gt; 2        0.16            -0.466       -0.572        -0.072     -0.17</span></span>
<span><span class="co">#&gt; 3        0.62            -0.141       -0.043        -0.552      0.23</span></span>
<span><span class="co">#&gt; 4       -0.12            -0.058       -1.063        -0.091     -1.06</span></span>
<span><span class="co">#&gt; 5       -0.17            -0.460       -0.099        -0.712     -0.66</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-many-factors-to-retain-in-factor-analysis-fa">How many factors to retain in Factor Analysis (FA)<a class="anchor" aria-label="anchor" href="#how-many-factors-to-retain-in-factor-analysis-fa"></a>
</h3>
<p>When running a <strong>factor analysis (FA)</strong>, one often needs
to specify <strong>how many components</strong> (or latent variables) to
retain or to extract. This decision is often motivated or supported by
some statistical indices and procedures aiming at finding the optimal
number of factors.</p>
<p>There are a huge number of methods exist to statistically address
this issue, and they can sometimes give very different results.</p>
<blockquote>
<p><strong>Unfortunately, there is no consensus on which method to use,
or which is the best.</strong></p>
</blockquote>
<div class="section level4">
<h4 id="the-method-agreement-procedure">The Method Agreement procedure<a class="anchor" aria-label="anchor" href="#the-method-agreement-procedure"></a>
</h4>
<p>The Method Agreement procedure, first implemented in the <a href="https://neuropsychology.github.io/psycho.R/2018/05/24/n_factors.html" class="external-link"><code>psycho</code></a>
package <span class="citation">(Makowski 2018)</span>, proposes to rely
on the consensus of methods, rather than on one method in
particular.</p>
<p>This procedure can be easily used via the <code><a href="../reference/n_factors.html">n_factors()</a></code>
function, re-implemented and improved in the <a href="https://github.com/easystats/parameters" class="external-link"><strong>parameters</strong></a>
package. One can provide a dataframe, and the function will run a large
number of routines and return the optimal number of factors based on the
higher consensus.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/n_factors.html">n_factors</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">n</span></span>
<span><span class="co">#&gt; # Method Agreement Procedure:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The choice of 6 dimensions is supported by 3 (15.79%) methods out of 19 (Optimal coordinates, Parallel analysis, Kaiser criterion).</span></span></code></pre></div>
<p>Interestingly, the smallest nubmer of factors that most methods
suggest is 6, which is consistent with the newer models of personality
(e.g., HEXACO).</p>
<p>More details, as well as a summary table can be obtained as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;    n_Factors              Method              Family</span></span>
<span><span class="co">#&gt; 1          1 Acceleration factor               Scree</span></span>
<span><span class="co">#&gt; 2          3                 CNG                 CNG</span></span>
<span><span class="co">#&gt; 3          4                beta Multiple_regression</span></span>
<span><span class="co">#&gt; 4          4    VSS complexity 1                 VSS</span></span>
<span><span class="co">#&gt; 5          5    VSS complexity 2                 VSS</span></span>
<span><span class="co">#&gt; 6          5       Velicer's MAP        Velicers_MAP</span></span>
<span><span class="co">#&gt; 7          6 Optimal coordinates               Scree</span></span>
<span><span class="co">#&gt; 8          6   Parallel analysis               Scree</span></span>
<span><span class="co">#&gt; 9          6    Kaiser criterion               Scree</span></span>
<span><span class="co">#&gt; 10         7                   t Multiple_regression</span></span>
<span><span class="co">#&gt; 11         7                   p Multiple_regression</span></span>
<span><span class="co">#&gt; 12         7          Scree (R2)            Scree_SE</span></span>
<span><span class="co">#&gt; 13         8          Scree (SE)            Scree_SE</span></span>
<span><span class="co">#&gt; 14         8                 BIC                 BIC</span></span>
<span><span class="co">#&gt; 15        11      BIC (adjusted)                 BIC</span></span>
<span><span class="co">#&gt; 16        22             Bentler             Bentler</span></span>
<span><span class="co">#&gt; 17        24            Bartlett             Barlett</span></span>
<span><span class="co">#&gt; 18        24            Anderson             Barlett</span></span>
<span><span class="co">#&gt; 19        24              Lawley             Barlett</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;    n_Factors n_Methods Variance_Cumulative</span></span>
<span><span class="co">#&gt; 1          1         1                0.19</span></span>
<span><span class="co">#&gt; 2          3         1                0.35</span></span>
<span><span class="co">#&gt; 3          4         2                0.41</span></span>
<span><span class="co">#&gt; 4          5         2                0.45</span></span>
<span><span class="co">#&gt; 5          6         3                0.48</span></span>
<span><span class="co">#&gt; 6          7         3                0.49</span></span>
<span><span class="co">#&gt; 7          8         2                0.51</span></span>
<span><span class="co">#&gt; 8         11         1                0.53</span></span>
<span><span class="co">#&gt; 9         22         1                0.57</span></span>
<span><span class="co">#&gt; 10        24         3                0.57</span></span></code></pre></div>
<p>A plot can also be obtained (the <code>see</code> package must be
loaded):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://easystats.github.io/see/reference/theme_modern.html" class="external-link">theme_modern</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="efa_cfa_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)<a class="anchor" aria-label="anchor" href="#confirmatory-factor-analysis-cfa"></a>
</h3>
<p>We’ve seen above that while an EFA with 5 latent variables works
great on our dataset, a structure with 6 latent factors might in fact be
more appropriate. How can we <strong>statistically test</strong> if that
is actually the case? This can be done using <strong>Confirmatory Factor
Analysis (CFA)</strong> (as opposed to <strong>Exploratory</strong> FA),
which bridges factor analysis with Structural Equation Modeling
(SEM).</p>
<p>However, in order to do that cleanly, EFA should be
<strong>independent</strong> from CFA: the factor structure should be
explored in a <strong>“training” set</strong>, and then tested (or
“confirmed”) in a <strong>“testing” set</strong>.</p>
<p>In other words, the dataset used for exploration and confirmation
should not be the same, a standard widely adopted in the field of
machine learning.</p>
<div class="section level4">
<h4 id="partition-the-data">Partition the data<a class="anchor" aria-label="anchor" href="#partition-the-data"></a>
</h4>
<p>The data can be easily split into two sets with the
<code>data_partition()</code> function, through which we will use 70% of
the sample as training and the rest as test.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to have reproducible result, we will also set seed here so that similar</span></span>
<span><span class="co"># portions of the data are used each time we run the following code</span></span>
<span><span class="va">partitions</span> <span class="op">&lt;-</span> <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_partition.html" class="external-link">data_partition</a></span><span class="op">(</span><span class="va">data</span>, training_proportion <span class="op">=</span> <span class="fl">0.7</span>, seed <span class="op">=</span> <span class="fl">111</span><span class="op">)</span></span>
<span><span class="va">training</span> <span class="op">&lt;-</span> <span class="va">partitions</span><span class="op">$</span><span class="va">p_0.7</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">partitions</span><span class="op">$</span><span class="va">test</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-cfa-structures-out-of-efa-models">Create CFA structures out of EFA models<a class="anchor" aria-label="anchor" href="#create-cfa-structures-out-of-efa-models"></a>
</h4>
<p>In the next step, we will run two EFA models on the training set,
specifying 5 and 6 latent factors respectively, that we will then
transform into CFA structures.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">structure_big5</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">training</span>, nfactors <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/convert_efa_to_cfa.html">efa_to_cfa</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">structure_big6</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html" class="external-link">fa</a></span><span class="op">(</span><span class="va">training</span>, nfactors <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/convert_efa_to_cfa.html">efa_to_cfa</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Investigate how the models look</span></span>
<span><span class="va">structure_big5</span></span>
<span><span class="co">#&gt; # Latent variables</span></span>
<span><span class="co">#&gt; MR2 =~ N1 + N2 + N3 + N4 + N5 + .row_id</span></span>
<span><span class="co">#&gt; MR1 =~ E1 + E2 + E3 + E4 + E5</span></span>
<span><span class="co">#&gt; MR3 =~ C1 + C2 + C3 + C4 + C5</span></span>
<span><span class="co">#&gt; MR5 =~ A1 + A2 + A3 + A4 + A5</span></span>
<span><span class="co">#&gt; MR4 =~ O1 + O2 + O3 + O4 + O5</span></span>
<span></span>
<span><span class="va">structure_big6</span></span>
<span><span class="co">#&gt; # Latent variables</span></span>
<span><span class="co">#&gt; MR2 =~ N1 + N2 + N3 + N5 + .row_id</span></span>
<span><span class="co">#&gt; MR3 =~ C1 + C2 + C3 + C4 + C5</span></span>
<span><span class="co">#&gt; MR1 =~ E1 + E2 + E4 + E5 + N4 + O4</span></span>
<span><span class="co">#&gt; MR5 =~ A1 + A2 + A3 + A4 + A5</span></span>
<span><span class="co">#&gt; MR4 =~ E3 + O1 + O2 + O3</span></span>
<span><span class="co">#&gt; MR6 =~ O5</span></span></code></pre></div>
<p>As we can see, a structure is just a string encoding how the
<strong>manifest variables</strong> (the observed variables) are
integrated into <strong>latent variables</strong>.</p>
</div>
<div class="section level4">
<h4 id="fit-and-compare-models">Fit and Compare models<a class="anchor" aria-label="anchor" href="#fit-and-compare-models"></a>
</h4>
<p>We can finally apply this structure to the testing dataset using the
<code>lavaan</code> package, and compare these models against each
other:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">big5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">structure_big5</span>, data <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">big6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">structure_big6</span>, data <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html" class="external-link">compare_performance</a></span><span class="op">(</span><span class="va">big5</span>, <span class="va">big6</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Comparison of Model Performance Indices</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name |  Model |     Chi2 | Chi2_df | p (Chi2) | Baseline(325) | p (Baseline)</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; big5 | lavaan | 1366.793 | 289.000 |   &lt; .001 |      5413.276 |       &lt; .001</span></span>
<span><span class="co">#&gt; big6 | lavaan | 1504.653 | 285.000 |   &lt; .001 |      5413.276 |       &lt; .001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name |   GFI |  AGFI |   NFI |  NNFI |   CFI | RMSEA |    RMSEA  CI | p (RMSEA)</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; big5 | 0.861 | 0.831 | 0.748 | 0.762 | 0.788 | 0.071 | [0.07, 0.08] |    &lt; .001</span></span>
<span><span class="co">#&gt; big6 | 0.854 | 0.820 | 0.722 | 0.727 | 0.760 | 0.077 | [0.07, 0.08] |    &lt; .001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name |    RMR |  SRMR |   RFI |  PNFI |   IFI |   RNI | Loglikelihood</span></span>
<span><span class="co">#&gt; ---------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; big5 | 12.332 | 0.076 | 0.716 | 0.665 | 0.790 | 0.788 |    -35860.601</span></span>
<span><span class="co">#&gt; big6 | 12.595 | 0.083 | 0.683 | 0.633 | 0.762 | 0.760 |    -35929.531</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name |   AIC (weights) |   BIC (weights) | BIC_adjusted</span></span>
<span><span class="co">#&gt; -------------------------------------------------------</span></span>
<span><span class="co">#&gt; big5 | 71845.2 (&gt;.999) | 72130.1 (&gt;.999) |    71933.186</span></span>
<span><span class="co">#&gt; big6 | 71991.1 (&lt;.001) | 72294.3 (&lt;.001) |    72084.722</span></span></code></pre></div>
<p>All in all, it seems that the Big-5 structure remains quite
reliable.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="structural-equation-modeling">Structural Equation Modeling<a class="anchor" aria-label="anchor" href="#structural-equation-modeling"></a>
</h2>
<!-- TO DO: needs a better intro -->
<p>The previous example shows one of the enormous amount of modeling
possibilities for structural equation models, in particular an example
for mediation analysis, i.e. a model that estimates indirect effects in
partial mediation structures.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">0.7</span> <span class="op">*</span> <span class="va">M</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, Y <span class="op">=</span> <span class="va">Y</span>, M <span class="op">=</span> <span class="va">M</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">" # direct effect</span></span>
<span><span class="st">             Y ~ c*X</span></span>
<span><span class="st">           # mediator</span></span>
<span><span class="st">             M ~ a*X</span></span>
<span><span class="st">             Y ~ b*M</span></span>
<span><span class="st">           # indirect effect (a*b)</span></span>
<span><span class="st">             ab := a*b</span></span>
<span><span class="st">           # total effect</span></span>
<span><span class="st">             total := c + (a*b)</span></span>
<span><span class="st">         "</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">df</span>, test <span class="op">=</span> <span class="st">"Satorra-Bentler"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/model_parameters.html">model_parameters</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Regression</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Link      | Coefficient |   SE |        95% CI |    z |      p</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Y ~ X (c) |        0.04 | 0.10 | [-0.17, 0.24] | 0.35 | 0.728 </span></span>
<span><span class="co">#&gt; M ~ X (a) |        0.47 | 0.10 | [ 0.27, 0.68] | 4.61 | &lt; .001</span></span>
<span><span class="co">#&gt; Y ~ M (b) |        0.79 | 0.09 | [ 0.61, 0.97] | 8.54 | &lt; .001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Defined</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To      | Coefficient |   SE |       95% CI |    z |      p</span></span>
<span><span class="co">#&gt; -----------------------------------------------------------</span></span>
<span><span class="co">#&gt; (ab)    |        0.37 | 0.09 | [0.19, 0.55] | 4.06 | &lt; .001</span></span>
<span><span class="co">#&gt; (total) |        0.41 | 0.12 | [0.17, 0.65] | 3.29 | 0.001</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-makowski2018psycho" class="csl-entry">
Makowski, Dominique. 2018. <span>“The Psycho Package: An Efficient and
Publishing-Oriented Workflow for Psychological Science.”</span>
<em>Journal of Open Source Software</em> 3 (22): 470.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Søren Højsgaard, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>

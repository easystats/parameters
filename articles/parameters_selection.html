<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selection of Model Parameters • parameters</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selection of Model Parameters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parameters</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.23.0.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Reference"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html" aria-label="Articles"><span class="fa fa-book-reader"></span> Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="News"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/parameters/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selection of Model Parameters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/parameters/blob/main/vignettes/parameters_selection.Rmd" class="external-link"><code>vignettes/parameters_selection.Rmd</code></a></small>
      <div class="d-none name"><code>parameters_selection.Rmd</code></div>
    </div>

    
    
<p>Also known as <a href="https://en.wikipedia.org/wiki/Feature_selection" class="external-link"><strong>feature
selection</strong></a> in machine learning, the goal of variable
selection is to <strong>identify a subset of predictors</strong> to
<strong>simplify models</strong>. This can benefit model interpretation,
shorten fitting time, and improve generalization (by reducing
overfitting).</p>
<p>There are many different methods. The appropriate method for a given
problem will depend on the model type, the data, the objective, and the
theoretical rationale.</p>
<p>The <code>parameters</code> package implements a helper that will
<strong>automatically</strong> pick a method deemed appropriate for the
provided model, run the variables selection and return the
<strong>optimal formula</strong>, which you can then re-use to update
the model.</p>
<div class="section level2">
<h2 id="simple-linear-regression">Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<div class="section level3">
<h3 id="fit-a-powerful-model">Fit a powerful model<a class="anchor" aria-label="anchor" href="#fit-a-powerful-model"></a>
</h3>
<p>If you are familiar with R and the formula interface, you know of the
possibility of including a dot (<code>.</code>) in the formula,
signifying “all the remaining variables”. Curiously, few are aware of
the possibility of additionally easily adding “all the interaction
terms”. This can be achieved using the <code>.*.</code> notation.</p>
<p>Let’s try that with the linear regression predicting
<strong>Sepal.Length</strong> with the <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set" class="external-link"><code>iris</code></a>
dataset, included by default in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span> <span class="op">*</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Sepal.Length ~ . * ., data = iris)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -0.726 -0.210  0.014  0.213  0.713 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)                      1.6998     1.0576    1.61   0.1103   </span></span>
<span><span class="co">#&gt; Sepal.Width                      0.8301     0.3047    2.72   0.0073 **</span></span>
<span><span class="co">#&gt; Petal.Length                     0.3178     0.7852    0.40   0.6863   </span></span>
<span><span class="co">#&gt; Petal.Width                      2.5827     1.5874    1.63   0.1061   </span></span>
<span><span class="co">#&gt; Speciesversicolor               -2.7193     1.6201   -1.68   0.0956 . </span></span>
<span><span class="co">#&gt; Speciesvirginica                -6.1704     3.2045   -1.93   0.0563 . </span></span>
<span><span class="co">#&gt; Sepal.Width:Petal.Length        -0.0149     0.2185   -0.07   0.9458   </span></span>
<span><span class="co">#&gt; Sepal.Width:Petal.Width         -0.6112     0.4536   -1.35   0.1801   </span></span>
<span><span class="co">#&gt; Sepal.Width:Speciesversicolor    0.4300     0.6666    0.65   0.5200   </span></span>
<span><span class="co">#&gt; Sepal.Width:Speciesvirginica     0.8288     1.0031    0.83   0.4101   </span></span>
<span><span class="co">#&gt; Petal.Length:Petal.Width        -0.1195     0.3300   -0.36   0.7178   </span></span>
<span><span class="co">#&gt; Petal.Length:Speciesversicolor   0.7398     0.5166    1.43   0.1544   </span></span>
<span><span class="co">#&gt; Petal.Length:Speciesvirginica    0.9034     0.6938    1.30   0.1951   </span></span>
<span><span class="co">#&gt; Petal.Width:Speciesversicolor   -1.0070     1.2454   -0.81   0.4202   </span></span>
<span><span class="co">#&gt; Petal.Width:Speciesvirginica    -0.2864     1.5065   -0.19   0.8495   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.3 on 135 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.882,  Adjusted R-squared:  0.87 </span></span>
<span><span class="co">#&gt; F-statistic: 72.1 on 14 and 135 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p><strong><em>Wow, that’s a lot of parameters! And almost none of them
are significant!</em></strong></p>
<p>Which is <strong><em>weird</em></strong>, considering that
<strong>gorgeous <span class="math inline">R^2</span> of
0.882!</strong></p>
<p><em>I wish I had that in my research!</em></p>
</div>
<div class="section level3">
<h3 id="too-many-parameters">Too many parameters?<a class="anchor" aria-label="anchor" href="#too-many-parameters"></a>
</h3>
<p>As you might know, having a <strong>model that is too performant is
not always a good thing</strong>. For instance, it can be a marker of <a href="https://en.wikipedia.org/wiki/Overfitting" class="external-link"><strong>overfitting</strong></a>:
the model corresponds too closely to a particular set of data, and may
therefore fail to predict future observations reliably. In multiple
regressions, in can also fall under the <a href="https://en.wikipedia.org/wiki/Freedman%27s_paradox" class="external-link"><strong>Freedman’s
paradox</strong></a>: some predictors that have actually no relation to
the dependent variable being predicted will be <strong>spuriously found
to be statistically significant</strong>.</p>
<p>Let’s run a few checks using the <a href="https://github.com/easystats/performance" class="external-link"><strong>performance</strong></a>
package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html" class="external-link">check_normality</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; OK: residuals appear as normally distributed (p = 0.612).</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_heteroscedasticity.html" class="external-link">check_heteroscedasticity</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; OK: Error variance appears to be homoscedastic (p = 0.118).</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_autocorrelation.html" class="external-link">check_autocorrelation</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; OK: Residuals appear to be independent and not autocorrelated (p = 0.574).</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_collinearity.html" class="external-link">check_collinearity</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Check for Multicollinearity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; High Correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Term      VIF           VIF 95% CI Increased SE Tolerance</span></span>
<span><span class="co">#&gt;               Sepal.Width    29.42 [   22.31,    38.91]         5.42      0.03</span></span>
<span><span class="co">#&gt;              Petal.Length  3204.78 [ 2414.74,  4253.41]        56.61  3.12e-04</span></span>
<span><span class="co">#&gt;               Petal.Width  2442.10 [ 1840.11,  3241.14]        49.42  4.09e-04</span></span>
<span><span class="co">#&gt;                   Species 3.98e+05 [3.00e+05, 5.28e+05]       630.97  2.51e-06</span></span>
<span><span class="co">#&gt;  Sepal.Width:Petal.Length  2183.98 [ 1645.63,  2898.55]        46.73  4.58e-04</span></span>
<span><span class="co">#&gt;   Sepal.Width:Petal.Width  1866.48 [ 1406.42,  2477.15]        43.20  5.36e-04</span></span>
<span><span class="co">#&gt;       Sepal.Width:Species 3.49e+05 [2.63e+05, 4.64e+05]       591.13  2.86e-06</span></span>
<span><span class="co">#&gt;  Petal.Length:Petal.Width  4032.80 [ 3038.60,  5352.41]        63.50  2.48e-04</span></span>
<span><span class="co">#&gt;      Petal.Length:Species 1.23e+06 [9.27e+05, 1.63e+06]      1109.09  8.13e-07</span></span>
<span><span class="co">#&gt;       Petal.Width:Species 3.77e+05 [2.84e+05, 5.01e+05]       614.38  2.65e-06</span></span>
<span><span class="co">#&gt;  Tolerance 95% CI</span></span>
<span><span class="co">#&gt;      [0.03, 0.04]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span>
<span><span class="co">#&gt;      [0.00, 0.00]</span></span></code></pre></div>
<p>The main issue of the model seems to be the high <a href="https://en.wikipedia.org/wiki/Multicollinearity" class="external-link">multicollinearity</a>.
This suggests that our model might not be able to give valid results
about any individual predictor, nor tell which predictors are redundant
with respect to others.</p>
</div>
<div class="section level3">
<h3 id="parameters-selection">Parameters selection<a class="anchor" aria-label="anchor" href="#parameters-selection"></a>
</h3>
<p>Time to do some variables selection! This can be easily done using
the <code><a href="../reference/select_parameters.html">select_parameters()</a></code> function in
<code>parameters</code>. It will <strong>automatically</strong> select
the best variables and update the model accordingly. One way of using
that is in a tidy pipeline (using <a href="https://cran.r-project.org/package=magrittr/" class="external-link"><code>%&gt;%</code></a>),
using this output to update a new model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span> <span class="op">*</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_parameters.html">select_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width + </span></span>
<span><span class="co">#&gt;     Species + Sepal.Width:Petal.Width + Petal.Length:Species + </span></span>
<span><span class="co">#&gt;     Petal.Width:Species, data = iris)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -0.7261 -0.2165  0.0021  0.2191  0.7439 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                       2.090      0.528    3.95  0.00012 ***</span></span>
<span><span class="co">#&gt; Sepal.Width                       0.734      0.130    5.66  8.3e-08 ***</span></span>
<span><span class="co">#&gt; Petal.Length                      0.232      0.260    0.89  0.37310    </span></span>
<span><span class="co">#&gt; Petal.Width                       1.051      0.532    1.98  0.04993 *  </span></span>
<span><span class="co">#&gt; Speciesversicolor                -1.047      0.547   -1.92  0.05754 .  </span></span>
<span><span class="co">#&gt; Speciesvirginica                 -2.682      0.638   -4.21  4.6e-05 ***</span></span>
<span><span class="co">#&gt; Sepal.Width:Petal.Width          -0.232      0.103   -2.24  0.02667 *  </span></span>
<span><span class="co">#&gt; Petal.Length:Speciesversicolor    0.660      0.298    2.22  0.02837 *  </span></span>
<span><span class="co">#&gt; Petal.Length:Speciesvirginica     0.720      0.273    2.63  0.00941 ** </span></span>
<span><span class="co">#&gt; Petal.Width:Speciesversicolor    -1.112      0.550   -2.02  0.04528 *  </span></span>
<span><span class="co">#&gt; Petal.Width:Speciesvirginica     -0.499      0.460   -1.09  0.27934    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.3 on 139 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.88,   Adjusted R-squared:  0.872 </span></span>
<span><span class="co">#&gt; F-statistic:  102 on 10 and 139 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>That’s still a lot of parameters, but as you can see, almost all of
them are now significant, and the <span class="math inline">R^2</span>
did not change much.</p>
<p>Although appealing, please note that these automated selection
methods are <a href="https://towardsdatascience.com/stopping-stepwise-why-stepwise-selection-is-bad-and-what-you-should-use-instead-90818b3f52df" class="external-link"><strong>quite
criticized</strong></a>, and should not be used in place of
<strong>theoretical</strong> or <strong>hypothetical</strong> reasons
(<em>i.e.</em>, you should have <em>a priori</em> hypotheses about which
parameters of your model you want to focus on).</p>
</div>
</div>
<div class="section level2">
<h2 id="mixed-models">Mixed models<a class="anchor" aria-label="anchor" href="#mixed-models"></a>
</h2>
<p>For simple linear regressions as above, the selection is made using
the <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step()</a></code> function (available in base R). This performs a
<a href="https://en.wikipedia.org/wiki/Stepwise_regression" class="external-link"><strong>stepwise</strong></a>
selection. However, this procedures is not available for other types of
models, such as <strong>mixed</strong> models.</p>
<div class="section level3">
<h3 id="mixed-models-1">Mixed models<a class="anchor" aria-label="anchor" href="#mixed-models-1"></a>
</h3>
<p>For mixed models (of class <code>merMod</code>), stepwise selection
is based on <code><a href="https://rdrr.io/pkg/cAIC4/man/stepcAIC.html" class="external-link">cAIC4::stepcAIC()</a></code>. This step function only
searches the “best” model based on the <em>random effects
structure</em>, i.e. <code><a href="../reference/select_parameters.html">select_parameters()</a></code> adds or excludes
random effects until the <code>cAIC</code> can’t be improved
further.</p>
<p>This is what our initial model looks like.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"qol_cancer"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initial model</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">phq4</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">hospital</span> <span class="op">/</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qol_cancer</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: QoL ~ time + phq4 + age + (1 + time | hospital/ID)</span></span>
<span><span class="co">#&gt;    Data: qol_cancer</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML criterion at convergence: 4647</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -3.581 -0.393  0.082  0.507  2.505 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups      Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  ID:hospital (Intercept) 202.49   14.23         </span></span>
<span><span class="co">#&gt;              time         12.54    3.54    -0.72</span></span>
<span><span class="co">#&gt;  hospital    (Intercept)   8.47    2.91         </span></span>
<span><span class="co">#&gt;              time          1.27    1.13    -1.00</span></span>
<span><span class="co">#&gt;  Residual                143.11   11.96         </span></span>
<span><span class="co">#&gt; Number of obs: 564, groups:  ID:hospital, 188; hospital, 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)  70.6514     3.1279   22.59</span></span>
<span><span class="co">#&gt; time          1.4896     1.2194    1.22</span></span>
<span><span class="co">#&gt; phq4         -4.7687     0.3235  -14.74</span></span>
<span><span class="co">#&gt; age          -0.0173     0.1889   -0.09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;      (Intr) time   phq4  </span></span>
<span><span class="co">#&gt; time -0.954              </span></span>
<span><span class="co">#&gt; phq4  0.014 -0.011       </span></span>
<span><span class="co">#&gt; age  -0.017  0.003  0.107</span></span>
<span><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span></code></pre></div>
<p>This is the model selected by <code><a href="../reference/select_parameters.html">select_parameters()</a></code>.
Please notice the differences in the random effects structure between
the initial and the selected models:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## TODO: this is currently broken due to an issue in package cAIC4</span></span>
<span></span>
<span><span class="co"># multiple models are checked, however, initial models</span></span>
<span><span class="co"># already seems to be the best one...</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">phq4</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">hospital</span> <span class="op">/</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qol_cancer</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_parameters.html">select_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Søren Højsgaard, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
